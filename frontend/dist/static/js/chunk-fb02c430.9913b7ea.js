(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fb02c430","chunk-2d21ee4a"],{"1ed2":function(t,e,n){},"28a5":function(t,e,n){"use strict";var i=n("aae3"),a=n("cb7c"),s=n("ebd6"),r=n("0390"),c=n("9def"),o=n("5f1b"),u=n("520a"),l=n("79e5"),f=Math.min,d=[].push,m="split",v="length",h="lastIndex",p=4294967295,g=!l((function(){RegExp(p,"y")}));n("214f")("split",2,(function(t,e,n,l){var b;return b="c"=="abbc"[m](/(b)*/)[1]||4!="test"[m](/(?:)/,-1)[v]||2!="ab"[m](/(?:ab)*/)[v]||4!="."[m](/(.?)(.?)/)[v]||"."[m](/()()/)[v]>1||""[m](/.?/)[v]?function(t,e){var a=String(this);if(void 0===t&&0===e)return[];if(!i(t))return n.call(a,t,e);var s,r,c,o=[],l=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),f=0,m=void 0===e?p:e>>>0,g=new RegExp(t.source,l+"g");while(s=u.call(g,a)){if(r=g[h],r>f&&(o.push(a.slice(f,s.index)),s[v]>1&&s.index<a[v]&&d.apply(o,s.slice(1)),c=s[0][v],f=r,o[v]>=m))break;g[h]===s.index&&g[h]++}return f===a[v]?!c&&g.test("")||o.push(""):o.push(a.slice(f)),o[v]>m?o.slice(0,m):o}:"0"[m](void 0,0)[v]?function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}:n,[function(n,i){var a=t(this),s=void 0==n?void 0:n[e];return void 0!==s?s.call(n,a,i):b.call(String(a),n,i)},function(t,e){var i=l(b,t,this,e,b!==n);if(i.done)return i.value;var u=a(t),d=String(this),m=s(u,RegExp),v=u.unicode,h=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(g?"y":"g"),y=new m(g?u:"^(?:"+u.source+")",h),_=void 0===e?p:e>>>0;if(0===_)return[];if(0===d.length)return null===o(y,d)?[d]:[];var x=0,C=0,w=[];while(C<d.length){y.lastIndex=g?C:0;var k,I=o(y,g?d:d.slice(C));if(null===I||(k=f(c(y.lastIndex+(g?0:C)),d.length))===x)C=r(d,C,v);else{if(w.push(d.slice(x,C)),w.length===_)return w;for(var O=1;O<=I.length-1;O++)if(w.push(I[O]),w.length===_)return w;C=x=k}}return w.push(d.slice(x)),w}]}))},"32f7":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.item.name===t.name?n("div",{staticClass:"clearfix"},[n("div",{staticClass:"chat-content",staticStyle:{float:"right"}},[n("p",{staticClass:"title"},[t._v(t._s(t.item.name)+"  "+t._s(t.item.time))]),t._v(" "),n("p",{staticClass:"content"},[t._v(t._s(t.item.content))])])]):n("div",{staticClass:"clearfix"},[n("div",{staticClass:"chat-content",staticStyle:{float:"left"}},[n("p",{staticClass:"title"},[t._v(t._s(t.item.name)+"  "+t._s(t.item.time))]),t._v(" "),n("p",{staticClass:"content"},[t._v(t._s(t.item.content))])])])},a=[],s={name:"ChatItem",props:{item:{type:Object,default:{}},name:{type:String,default:""}}},r=s,c=(n("521a"),n("2877")),o=Object(c["a"])(r,i,a,!1,null,"4581f108",null);e["a"]=o.exports},3846:function(t,e,n){n("9e1e")&&"g"!=/./g.flags&&n("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:n("0bfb")})},"521a":function(t,e,n){"use strict";var i=n("e767"),a=n.n(i);a.a},"5d58":function(t,e,n){t.exports=n("d8d6")},"67bb":function(t,e,n){t.exports=n("f921")},"6b54":function(t,e,n){"use strict";n("3846");var i=n("cb7c"),a=n("0bfb"),s=n("9e1e"),r="toString",c=/./[r],o=function(t){n("2aba")(RegExp.prototype,r,t,!0)};n("79e5")((function(){return"/a/b"!=c.call({source:"a",flags:"b"})}))?o((function(){var t=i(this);return"/".concat(t.source,"/","flags"in t?t.flags:!s&&t instanceof RegExp?a.call(t):void 0)})):c.name!=r&&o((function(){return c.call(this)}))},"6d28":function(t,e,n){"use strict";var i=n("1ed2"),a=n.n(i);a.a},"6f29":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"chat"}},[n("el-row",[n("el-col",{attrs:{span:16}},[n("div",{staticClass:"chat-box"},t._l(t.messages,(function(e){return n("div",{key:e.timezone},[n("chat-item",{attrs:{item:e,name:t.name}})],1)})),0)]),t._v(" "),n("el-col",{attrs:{span:8}},[n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[t._v("在线用户")])]),t._v(" "),t._l(t.users,(function(e){return n("div",{key:e,staticClass:"text item"},[t._v("\n            "+t._s(e)+"\n          ")])})),t._v(" "),n("br"),t._v(" "),n("el-form",{staticClass:"chat-msg",attrs:{inline:!0,model:t.formInline},nativeOn:{submit:function(t){t.preventDefault()}}},[n("el-form-item",{attrs:{label:"消息"}},[n("el-input",{nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.send(e)}},model:{value:t.formInline.msg,callback:function(e){t.$set(t.formInline,"msg",e)},expression:"formInline.msg"}})],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"success",plain:""},nativeOn:{click:function(e){return e.preventDefault(),t.send(e)}}},[t._v("发送")])],1)],1)],2),t._v(" "),n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[t._v("使用说明")])]),t._v(" "),n("p",{staticClass:"tips",staticStyle:{color:"#f50","line-height":"1.4"}},[t._v("\n            本事例使用laravel + laravel-echo-server,利用广播推送功能完成。\n            为了模拟演示聊天室效果，你可以同时使用多个不同的浏览器分别用不同的系统管理员用户来登录，就可以在聊天室相互发送消息了。\n          ")])])],1)],1)],1)},a=[],s=(n("7f7f"),n("20d6"),n("db72")),r=n("d800"),c=n("2f62"),o=n("ed08"),u=n("32f7"),l={name:"chat_index",components:{ChatItem:u["a"]},data:function(){return{users:[],formInline:{msg:""},messages:[]}},computed:Object(s["a"])({},Object(c["b"])(["name"])),beforeRouteLeave:function(t,e,n){window.Echo.leave("chat"),n()},beforeRouteEnter:function(t,e,n){n((function(t){window.Echo.join("chat").here((function(e){t.users=e})).joining((function(e){t.users.push(e),t.$notify({title:"提示",message:"".concat(e,"轻轻的加入了聊天室"),type:"success"})})).leaving((function(e){var n=t.users.findIndex((function(t){return t===e}));t.users.splice(n,1),t.$notify({title:"提示",message:"".concat(e,"悄悄的离开了聊天室"),type:"default"})})).listen("Chat",(function(e){var n=e.msg;n.name!==t.name&&t.messages.push(n)}))}))},created:function(){var t=this;document.onkeydown=function(e){if(void 0==window.event)var n=e.keyCode;else n=window.event.keyCode;13===n&&t.send()}},methods:{send:function(){if(!this.formInline.msg)return!1;var t={name:this.name,timezone:Date.now(),time:Object(o["a"])(Date.now()),content:this.formInline.msg};this.formInline.msg="",this.messages.push(t),Object(r["sendChat"])(t).then((function(){}))}}},f=l,d=(n("6d28"),n("2877")),m=Object(d["a"])(f,i,a,!1,null,"f986a7aa",null);e["default"]=m.exports},7618:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n("5d58"),a=n.n(i),s=n("67bb"),r=n.n(s);function c(t){return c="function"===typeof r.a&&"symbol"===typeof a.a?function(t){return typeof t}:function(t){return t&&"function"===typeof r.a&&t.constructor===r.a&&t!==r.a.prototype?"symbol":typeof t},c(t)}},d800:function(t,e,n){"use strict";n.r(e),n.d(e,"sendChat",(function(){return a})),n.d(e,"getCustomer",(function(){return s})),n.d(e,"sendKefu",(function(){return r}));var i=n("1c1e");function a(t){return Object(i["a"])({url:"/api/chat",method:"post",data:t})}function s(){return new Promise((function(t,e){var n={name:"wmhello"};t(n)}))}function r(t){return Object(i["a"])({url:"/api/kefu",method:"post",data:t})}},e767:function(t,e,n){},ed08:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));n("28a5"),n("a481"),n("6b54");var i=n("7618");function a(t,e){if(0===arguments.length)return null;var n,a=e||"{y}-{m}-{d} {h}:{i}:{s}";"object"===Object(i["a"])(t)?n=t:("string"===typeof t&&/^[0-9]+$/.test(t)&&(t=parseInt(t)),"number"===typeof t&&10===t.toString().length&&(t*=1e3),n=new Date(t));var s={y:n.getFullYear(),m:n.getMonth()+1,d:n.getDate(),h:n.getHours(),i:n.getMinutes(),s:n.getSeconds(),a:n.getDay()},r=a.replace(/{(y|m|d|h|i|s|a)+}/g,(function(t,e){var n=s[e];return"a"===e?["日","一","二","三","四","五","六"][n]:(t.length>0&&n<10&&(n="0"+n),n||0)}));return r}}}]);